using System.Linq.Expressions;
using System;
using HRManagementApp.Models;
using HRManagementApp.Services;
using HRManagementApp.Interfaces;

HumanResourceManagerService hrm = new HumanResourceManagerService();
string command = "";

while (true)
{
    Console.WriteLine("\n-------Main Menu-------");
    Console.WriteLine("1- Add Employee");
    Console.WriteLine("2- Edit Employee");
    Console.WriteLine("3- Get Departments");
    Console.WriteLine("4- Add Department");
    Console.WriteLine("5- Edit Department");
    Console.WriteLine("6- Get All Employees");
    Console.WriteLine("7- Search Employee");
    Console.WriteLine("8- Remove Employee");
    Console.WriteLine("9- Remove Department");
    Console.WriteLine("0- Exit");
    Console.Write("Emeliyyat secin: ");
    command = Console.ReadLine();
    
    switch (command)
    {
        case "1":
            AddEmployee(hrm);
            break;
        case "2":
            EditEmployee(hrm);
            break;
        case "3":
            GetDepartments(hrm);
            break;
        case "4":
            AddDepartment(hrm);
            break;
        case "5":
            EditDepartment(hrm);
            break;
        case "6":
            GetAllEmployees(hrm);
            break;
        case "7":
            SearchEmployee(hrm);
            break;
        case "8":
            RemoveEmployee(hrm);
            break;
        case "9":
            RemoveDepartment(hrm);
            break;
        case "0":
            Console.WriteLine("Proqramdan cixilir...");
            Environment.Exit(0);
            break;
        default:
            Console.WriteLine("Yanlis emeliyyat secdiniz");
            break;
    }
}

static void AddEmployee(HumanResourceManagerService hrm)
{
    Console.Write("Fullname: ");
    string fullName = Console.ReadLine();
    Console.Write("Department Name: ");
    string departmentName = Console.ReadLine();
    Console.Write("Position: ");
    string position = Console.ReadLine();
    Console.Write("Salary: ");
    double salary = Convert.ToDouble(Console.ReadLine());
    
    try
    {
        hrm.AddEmployee(fullName, departmentName, position, salary);
        Console.WriteLine($"{fullName} adli isci ugurla elave olundu");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

static void EditEmployee(HumanResourceManagerService hrm)
{
    Console.Write("Employee No: ");
    string no = Console.ReadLine();
    Console.Write("New Position: ");
    string newPosition = Console.ReadLine();
    Console.Write("New Salary: ");
    double newSalary = Convert.ToDouble(Console.ReadLine());
    
    try
    {
        hrm.EditEmployee(no, newPosition, newSalary);
        Console.WriteLine($"{no} nomreli isci ugurla deyisdirildi");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

static void GetDepartments(HumanResourceManagerService hrm)
{
    hrm.GetAllDepartments();
}

static void AddDepartment(HumanResourceManagerService hrm)
{
    Console.Write("Department Name: ");
    string name = Console.ReadLine();
    Console.Write("Employee Limit: ");
    int employeeLimit = Convert.ToInt32(Console.ReadLine());
    Console.Write("Salary Limit: ");
    double salaryLimit = Convert.ToDouble(Console.ReadLine());
    
    try
    {
        hrm.AddDepartment(name, employeeLimit, salaryLimit);
        Console.WriteLine($"{name} adli department ugurla elave olundu");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

static void EditDepartment(HumanResourceManagerService hrm)
{
    Console.Write("Department Name: ");
    string deptName = Console.ReadLine();
    Console.Write("New Employee Limit: ");
    int newEmployeeLimit = Convert.ToInt32(Console.ReadLine());
    Console.Write("New Salary Limit: ");
    double newSalaryLimit = Convert.ToDouble(Console.ReadLine());
    
    try
    {
        hrm.EditDepartment(deptName, newEmployeeLimit, newSalaryLimit);
        Console.WriteLine($"{deptName} adli department ugurla deyisdirildi");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

static void GetAllEmployees(HumanResourceManagerService hrm)
{
    hrm.GetAllEmployees();
}

static void SearchEmployee(HumanResourceManagerService hrm)
{
    Console.Write("Search: ");
    string search = Console.ReadLine();
    hrm.SearchEmployee(search);
}

static void RemoveEmployee(HumanResourceManagerService hrm)
{
    Console.Write("Employee No: ");
    string empNo = Console.ReadLine();
    
    try
    {
        hrm.RemoveEmployee(empNo);
        Console.WriteLine($"{empNo} nomreli isci ugurla silindi");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

static void RemoveDepartment(HumanResourceManagerService hrm)
{
    Console.Write("Department Name: ");
    string deptToRemove = Console.ReadLine();
    
    try
    {
        hrm.RemoveDepartment(deptToRemove);
        Console.WriteLine($"{deptToRemove} adli department ugurla silindi");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"Xeta: {ex.Message}");
    }
}

